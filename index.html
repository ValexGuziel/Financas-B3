<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Finance App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    :root {
      --bg: #0f172a;
      --card: #020617;
      --border: #1e293b;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --primary: #38bdf8;
      --danger: #ef4444;
      --success: #22c55e;
    }

    * {
      box-sizing: border-box;
      font-family: Segoe UI, Roboto, Arial
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      padding-bottom: 70px
    }

    header {
      background: var(--card);
      border-bottom: 1px solid var(--border);
      padding: 14px 20px
    }

    .container {
      max-width: 1200px;
      margin: auto;
      padding: 20px
    }

    .grid {
      display: grid;
      gap: 16px
    }

    .grid-4 {
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr))
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 18px
    }

    .card small {
      color: var(--muted)
    }

    .card strong {
      display: block;
      font-size: 20px;
      margin-top: 6px
    }

    input,
    select {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #020617;
      color: var(--text);
      margin-bottom: 10px
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px
    }

    th,
    td {
      padding: 10px;
      border-bottom: 1px solid var(--border)
    }

    .pagination {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      margin-top: 10px
    }

    .nav-bottom {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--card);
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-around;
      padding: 8px 0
    }

    .nav-item {
      text-align: center;
      font-size: 12px;
      color: var(--muted);
      cursor: pointer
    }

    .nav-item.active {
      color: var(--primary);
      font-weight: 600
    }

    .nav-item span {
      display: block;
      font-size: 18px
    }

    .page {
      display: none
    }

    .page.active {
      display: block
    }

    .positivo {
      color: var(--success)
    }

    .negativo {
      color: var(--danger)
    }
  </style>
</head>

<body>

  <header><strong>üìä Finance App</strong></header>

  <div class="container">

    <section id="radar" class="page active">
      <h2>Radar</h2>

      <div class="grid grid-4">
        <div class="card"><small>D√≥lar</small><strong id="dolar">--</strong></div>
        <div class="card"><small>SELIC</small><strong id="selic">--</strong></div>
        <div class="card"><small>IPCA</small><strong id="ipca">--</strong></div>
        <div class="card"><small>CDI</small><strong id="cdi">--</strong></div>
      </div>

      <h3 style="margin-top:24px">A√ß√µes da B3</h3>
      <input id="busca" placeholder="Buscar por ticker ou empresa...">

      <div class="card">
        <table>
          <thead>
            <tr>
              <th>Ticker</th>
              <th>Empresa</th>
              <th>Pre√ßo</th>
            </tr>
          </thead>
          <tbody id="acoes"></tbody>
        </table>

        <div class="pagination">
          <button onclick="prevPage()">Anterior</button>
          <button onclick="nextPage()">Pr√≥xima</button>
        </div>
      </div>
    </section>

    <section id="carteira" class="page">
      <h2>Carteira</h2>

      <div class="card">
        <input id="cticker" placeholder="Ticker">
        <input id="cqt" type="number" placeholder="Quantidade">
        <input id="cpreco" type="number" placeholder="Pre√ßo m√©dio">
        <button onclick="addAtivo()">Adicionar</button>
      </div>

      <div class="card" style="margin-top:16px">
        <table>
          <thead>
            <tr>
              <th>Ticker</th>
              <th>Qtd</th>
              <th>Pre√ßo</th>
              <th>Valor Atual</th>
              <th>Resultado</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="listaCarteira"></tbody>
        </table>
      </div>
    </section>

    <section id="gastos" class="page">
      <h2>Ganhos & Gastos</h2>

      <div class="card">
        <input id="desc" placeholder="Descri√ß√£o">
        <input id="valor" type="number" placeholder="Valor">
        <select id="tipo">
          <option value="ganho">Ganho</option>
          <option value="gasto">Gasto</option>
        </select>
        <button onclick="addMov()">Adicionar</button>
      </div>

      <div class="grid grid-4" style="margin-top:16px">
        <div class="card"><small>Ganhos</small><strong id="totalGanhos">R$ 0</strong></div>
        <div class="card"><small>Gastos</small><strong id="totalGastos">R$ 0</strong></div>
        <div class="card"><small>Saldo</small><strong id="saldo">R$ 0</strong></div>
      </div>

      <div class="card" style="margin-top:16px">
        <table>
          <thead>
            <tr>
              <th>Descri√ß√£o</th>
              <th>Tipo</th>
              <th>Valor</th>
            </tr>
          </thead>
          <tbody id="lista"></tbody>
        </table>
      </div>
    </section>

    <section id="resumo" class="page">
      <h2>Resumo</h2>
      <div class="grid grid-4">
        <div class="card"><small>Ganhos</small><strong id="rGanhos">R$ 0</strong></div>
        <div class="card"><small>Gastos</small><strong id="rGastos">R$ 0</strong></div>
        <div class="card"><small>Saldo</small><strong id="rSaldo">R$ 0</strong></div>
        <div class="card"><small>Investido</small><strong id="rInvestido">R$ 0</strong></div>
        <div class="card"><small>Resultado Carteira</small><strong id="rResultado">R$ 0</strong></div>
      </div>
    </section>

  </div>

  <nav class="nav-bottom">
    <div class="nav-item active" onclick="show('radar',this)"><span>üì°</span>Radar</div>
    <div class="nav-item" onclick="show('carteira',this)"><span>üíº</span>Carteira</div>
    <div class="nav-item" onclick="show('gastos',this)"><span>üí∏</span>Gastos</div>
    <div class="nav-item" onclick="show('resumo',this)"><span>üìä</span>Resumo</div>
  </nav>

  <script>
    /* ===== NAVEGA√á√ÉO ===== */
    function show(id, el) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      el.classList.add('active');
      atualizarResumo();
    }

    /* ===== RADAR ===== */
    let precosRadar = {};
    let todasAcoes = [], pagina = 1, porPagina = 15;

    function renderAcoes() {
      const termo = busca.value.toLowerCase();
      const f = todasAcoes.filter(a => a.stock.toLowerCase().includes(termo) || a.name.toLowerCase().includes(termo));
      const s = f.slice((pagina - 1) * porPagina, pagina * porPagina);
      acoes.innerHTML = "";
      s.forEach(a => acoes.innerHTML += `<tr><td>${a.stock}</td><td>${a.name}</td><td>R$ ${a.close}</td></tr>`);
    }
    busca.oninput = () => { pagina = 1; renderAcoes() };
    function nextPage() { pagina++; renderAcoes() }
    function prevPage() { if (pagina > 1) pagina--; renderAcoes() }

    fetch("https://brapi.dev/api/quote/list")
      .then(r => r.json())
      .then(d => {
        todasAcoes = d.stocks || [];
        todasAcoes.forEach(a => precosRadar[a.stock] = a.close);
        renderAcoes();
        renderCarteira();
      });

    /* ===== INDICADORES ===== */
    const series = { dolar: 1, selic: 11, ipca: 433, cdi: 12 };
    for (const [id, v] of Object.entries(series)) {
      fetch(`https://api.bcb.gov.br/dados/serie/bcdata.sgs.${v}/dados/ultimos/1?formato=json`)
        .then(r => r.json())
        .then(d => document.getElementById(id).textContent = id === "dolar" ? "R$ " + (+d[0].valor).toFixed(2) : d[0].valor + "%");
    }

    /* ===== GASTOS ===== */
    let dados = JSON.parse(localStorage.getItem("financas")) || [];
    function salvarFinancas() { localStorage.setItem("financas", JSON.stringify(dados)) }
    function addMov() {
      if (!desc.value || valor.value <= 0) return alert("Preencha corretamente");
      dados.push({ d: desc.value, v: +valor.value, t: tipo.value });
      desc.value = valor.value = "";
      salvarFinancas(); renderFin();
    }
    function renderFin() {
      let g = 0, ga = 0; lista.innerHTML = "";
      dados.forEach(m => { m.t === "ganho" ? g += m.v : ga += m.v; lista.innerHTML += `<tr><td>${m.d}</td><td>${m.t}</td><td>R$ ${m.v.toFixed(2)}</td></tr>` });
      totalGanhos.textContent = "R$ " + g.toFixed(2);
      totalGastos.textContent = "R$ " + ga.toFixed(2);
      saldo.textContent = "R$ " + (g - ga).toFixed(2);
      atualizarResumo();
    }
    renderFin();

    /* ===== CARTEIRA ===== */
    let carteira = JSON.parse(localStorage.getItem("carteira")) || [];
    function salvarCarteira() { localStorage.setItem("carteira", JSON.stringify(carteira)) }
    function addAtivo() {
      if (!cticker.value || cqt.value <= 0 || cpreco.value <= 0) return alert("Preencha corretamente");
      carteira.push({ t: cticker.value.toUpperCase(), q: +cqt.value, p: +cpreco.value });
      cticker.value = cqt.value = cpreco.value = "";
      salvarCarteira(); renderCarteira();
    }
    function editarQuantidade(i) {
      const q = prompt("Nova quantidade:", carteira[i].q);
      if (q <= 0) return;
      carteira[i].q = +q; salvarCarteira(); renderCarteira();
    }
    function removerAtivo(i) {
      if (!confirm("Remover ativo?")) return;
      carteira.splice(i, 1); salvarCarteira(); renderCarteira();
    }
    function renderCarteira() {
      listaCarteira.innerHTML = "";
      let invest = 0, res = 0;
      carteira.forEach((a, i) => {
        invest += a.q * a.p;
        const atual = precosRadar[a.t];
        const total = atual ? atual * a.q : 0;
        const r = atual ? total - (a.q * a.p) : 0;
        res += r;
        listaCarteira.innerHTML += `
   <tr>
    <td>${a.t}</td><td>${a.q}</td><td>R$ ${a.p.toFixed(2)}</td>
    <td>${atual ? "R$ " + total.toFixed(2) : "--"}</td>
    <td class="${r >= 0 ? 'positivo' : 'negativo'}">${atual ? "R$ " + r.toFixed(2) : "--"}</td>
    <td><button onclick="editarQuantidade(${i})">‚úèÔ∏è</button> <button onclick="removerAtivo(${i})">üóë</button></td>
   </tr>`;
      });
      rInvestido.textContent = "R$ " + invest.toFixed(2);
      rResultado.textContent = "R$ " + res.toFixed(2);
    }
    renderCarteira();

    /* ===== RESUMO ===== */
    function atualizarResumo() {
      let g = 0, ga = 0;
      dados.forEach(m => m.t === "ganho" ? g += m.v : ga += m.v);
      rGanhos.textContent = "R$ " + g.toFixed(2);
      rGastos.textContent = "R$ " + ga.toFixed(2);
      rSaldo.textContent = "R$ " + (g - ga).toFixed(2);
    }
  </script>

</body>

</html>